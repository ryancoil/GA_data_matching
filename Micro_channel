New_class_system_Sess$class_sys <-  ifelse(New_class_system_Sess$sourceMedium == '(direct) / (none)', 'direct', 
                                           ifelse(New_class_system_Sess$sourceMedium == 'email / newsletter','Email - Newlsetter',    
                                                  ifelse(New_class_system_Sess$sourceMedium == 'bluecore / email'| New_class_system_Sess$sourceMedium == 'email / welcome','Email - triggered',
                                                         ifelse(grepl('nontm', New_class_system_Sess$campaign) & grepl('shop', New_class_system_Sess$campaign) ,'NBPS - shopping',
                                                                ifelse(grepl('nontm', New_class_system_Sess$campaign) & grepl('acqu', New_class_system_Sess$campaign) ,'NBPS - acquisition',
                                                                       ifelse(grepl('youtube', New_class_system_Sess$campaign) ,'Youtube - preroll',
                                                                              ifelse(grepl('nontm', New_class_system_Sess$campaign) ,'NBPS - remainder',
                                                                                     ifelse(grepl('- tm -', New_class_system_Sess$campaign) & grepl('shop', New_class_system_Sess$campaign)  ,'Brand - shopping',
                                                                                            ifelse(grepl('- tm -', New_class_system_Sess$campaign) & grepl('acq', New_class_system_Sess$campaign)  ,'Brand - acquisition',
                                                                                                   ifelse(grepl('- tm -', New_class_system_Sess$campaign) , 'Brand - remainder',
                                                                                                          ifelse(grepl('gsp - remark', New_class_system_Sess$campaign) & grepl('acq', New_class_system_Sess$campaign)| 
                                                                                                                   grepl('- acquisition - dn - remarketing ', New_class_system_Sess$campaign)|grepl('dn - remark',New_class_system_Sess$campaign),'GSP Remarketing - acquisition',
                                                                                                                 ifelse(grepl('dn - prospect', New_class_system_Sess$campaign)  ,'GSP - prospecting',
                                                                                                                        ifelse(grepl('gsp - remark', New_class_system_Sess$campaign)  ,'GSP Remarketing - remainder',
                                                                                                                               ifelse(grepl('impactradius', New_class_system_Sess$sourceMedium) & grepl('loyal', New_class_system_Sess$sourceMedium),'Affiliate - Loyalty',
                                                                                                                                      ifelse(grepl('impactradius', New_class_system_Sess$sourceMedium) & grepl('coupon', New_class_system_Sess$sourceMedium),'Affiliate - Coupon',      
                                                                                                                                             ifelse(grepl('impactradius', New_class_system_Sess$sourceMedium)|grepl('affiliate', New_class_system_Sess$sourceMedium),'Affiliate - Remainder',      
                                                                                                                                                    ifelse(grepl('criteo', New_class_system_Sess$sourceMedium) & grepl('retar', New_class_system_Sess$campaign),'Criteo - Retargeting',     
                                                                                                                                                           ifelse(grepl('criteo', New_class_system_Sess$sourceMedium) & grepl('audience', New_class_system_Sess$campaign),'Criteo - Audience match',     
                                                                                                                                                                  ifelse(grepl('criteo', New_class_system_Sess$sourceMedium) & grepl('acq', New_class_system_Sess$campaign),'Criteo - Acquisition',     
                                                                                                                                                                         ifelse(grepl('criteo', New_class_system_Sess$sourceMedium), 'Criteo - Remainder', 
                                                                                                                                                                                ifelse(grepl('facebook / paidsocial', New_class_system_Sess$sourceMedium) & grepl('prosp', New_class_system_Sess$campaign), 'Pd Social - Paid Acquisition', 
                                                                                                                                                                                       ifelse(grepl('facebook / paidsocial', New_class_system_Sess$sourceMedium) & grepl('remar', New_class_system_Sess$campaign), 'Pd Social - Remarketing', 
                                                                                                                                                                                              ifelse(grepl('facebook / paidsocial', New_class_system_Sess$sourceMedium) | grepl('instagram / paid', New_class_system_Sess$sourceMedium), 'Pd Social - Remainder', 
                                                                                                                                                                                                     ifelse(grepl('facebook.com / ref', New_class_system_Sess$sourceMedium)| grepl('gram.com / ref',New_class_system_Sess$sourceMedium)|
                                                                                                                                                                                                              grepl('pinterest.com / ref',New_class_system_Sess$sourceMedium)| grepl('/ social', New_class_system_Sess$sourceMedium)|
                                                                                                                                                                                                              grepl('social / ', New_class_system_Sess$sourceMedium) , 'social - organic',
                                                                                                                                                                                                            ifelse(grepl('organic', New_class_system_Sess$sourceMedium), 'search - organic', 
                                                                                                                                                                                                                   ifelse(grepl('referral', New_class_system_Sess$sourceMedium), 'referral', 
                                                                                                                                                                                                                          ifelse(grepl('cpc', New_class_system_Sess$sourceMedium) ,'Paid - remainder', 'other')))))))))))))))))))))))))))
